import{a as _}from"./Bjtksisr.js";import{d as w,b4 as C,aT as D,r as d,ad as N,b5 as h,h as x,g as s,e as u,w as c,o as S,k as y,u as g,a0 as v}from"./CKxg9VfS.js";import{B as T}from"./CkclNe_0.js";import{_ as V}from"./CEFh3Vxc.js";import{_ as k}from"./DboHdRIr.js";import{_ as z}from"./Bt2YpT3E.js";import"./mUUuLyVv.js";import"./CbhVS3Xc.js";import"./Be7d-GBD.js";import"./ChAwXecA.js";import"./fmyKo3Du.js";import"./gy6MXjwN.js";import"./CeAEZXwI.js";import"./BH030lJW.js";import"./Be3VPoHw.js";import"./BloDjXvy.js";import"./BHMcXTSu.js";import"./CMIqKt_m.js";import"./DDBjNozI.js";import"./CfojvlWq.js";import"./DlZP_T-Q.js";import"./DpFlcqSt.js";import"./BH33Gl0k.js";import"./HiGXOwLp.js";const B={class:"flex justify-between items-center mb-4"},M={class:"flex gap-2"},se=w({__name:"index",setup(P){C();const R=D(),i=d(!1),l=d([]),a=d({page:1,pageSize:10,showSizePicker:!0,pageSizes:[10,20,30,50],onChange:e=>{a.value.page=e,p()},onUpdatePageSize:e=>{a.value.pageSize=e,a.value.page=1,p()}}),A=[{title:"Return Number",key:"returnNumber",sorter:"default",width:150},{title:"Type",key:"type",width:100,render:e=>{const t=!!e.invoice;return v(k,{type:t?"success":"info",round:!0},{default:()=>t?"Customer":"Supplier"})}},{title:"Reference",key:"reference",render:e=>{var t,r;return e.invoice?((t=e.invoice)==null?void 0:t.invoice_no)||"N/A":e.purchase&&((r=e.purchase)==null?void 0:r.invoice_no)||"N/A"}},{title:"Customer/Supplier",key:"party",render:e=>{var t,r;return e.customer?((t=e.customer)==null?void 0:t.full_name)||"Walk-in Customer":e.supplier?((r=e.supplier)==null?void 0:r.name)||"Unknown Supplier":"N/A"}},{title:"Return Date",key:"returnDate",render:e=>new Date(e.returnDate).toLocaleDateString(),sorter:(e,t)=>new Date(e.returnDate).getTime()-new Date(t.returnDate).getTime()},{title:"Items",key:"itemCount",width:80,render:e=>{var t;return((t=e.items)==null?void 0:t.length)||0}},{title:"Total Amount",key:"totalAmount",render:e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(e.totalAmount||0),sorter:(e,t)=>(e.totalAmount||0)-(t.totalAmount||0)},{title:"Status",key:"status",render:e=>{var n;const r={pending:{type:"warning",label:"Pending"},completed:{type:"success",label:"Completed"},cancelled:{type:"error",label:"Cancelled"}}[(n=e.status)==null?void 0:n.toLowerCase()]||{type:"default",label:e.status};return v(k,{type:r.type,round:!0},{default:()=>r.label})}},{title:"Reason",key:"reason",ellipsis:{tooltip:!0}}],p=async()=>{i.value=!0;try{const[e,t]=await Promise.all([_.get("/api/returns/customer"),_.get("/api/returns/supplier")]),r=e.status&&e.data?Array.isArray(e.data)?e.data:[]:[],n=t.status&&t.data?Array.isArray(t.data)?t.data:[]:[];l.value=[...r,...n].sort((m,o)=>new Date(o.returnDate).getTime()-new Date(m.returnDate).getTime())}catch(e){console.error("Error fetching returns:",e),l.value=[]}finally{i.value=!1}},b=e=>{a.value.page=e};function f(e){console.log(`Navigating to ${e} add page`),R.push(`/returns/${e}/add`)}return N(()=>{p()}),h({title:"Returns Management"}),(e,t)=>{const r=T,n=V,m=z;return S(),x("div",null,[s("div",B,[t[4]||(t[4]=s("div",null,[s("h1",{class:"text-2xl font-bold"},"Returns Management"),s("p",{class:"text-gray-500 dark:text-gray-400"}," View all customer and supplier returns ")],-1)),s("div",M,[u(r,{onClick:t[0]||(t[0]=o=>f("customer"))},{default:c(()=>t[2]||(t[2]=[y(" New Customer Return ")])),_:1,__:[2]}),u(r,{onClick:t[1]||(t[1]=o=>f("supplier"))},{default:c(()=>t[3]||(t[3]=[y(" New Supplier Return ")])),_:1,__:[3]})])]),u(m,{title:"All Returns",class:"mt-4"},{default:c(()=>[u(n,{columns:A,data:g(l),loading:g(i),pagination:g(a),"row-key":o=>o._id,"onUpdate:page":b},null,8,["data","loading","pagination","row-key"])]),_:1})])}}});export{se as default};
