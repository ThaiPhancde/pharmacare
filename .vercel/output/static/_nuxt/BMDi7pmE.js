import{d as S,aI as V,r as f,ad as T,h as A,g as v,e as t,w as n,u as m,o as P,k as i,i as j,t as M,a0 as b,P as z}from"./CKxg9VfS.js";import{_ as L}from"./tYwaLfcc.js";import{u as G}from"./Bpf85daN.js";import{a as k}from"./Bjtksisr.js";import{B as H}from"./CkclNe_0.js";import{_ as J}from"./CWYSDPom.js";import{P as O}from"./CdaYbVMG.js";import{_ as W}from"./B6-CO9cE.js";import{_ as X}from"./BjVYSpcv.js";import{_ as Y}from"./DpFlcqSt.js";import{_ as Z}from"./DC7NDAF6.js";import{_ as ee,a as ae}from"./fmyKo3Du.js";import{_ as te}from"./B8BHpYNb.js";import{P as ne}from"./CZYgztcZ.js";import{T as oe}from"./HXfFxbHn.js";import"./DZHg-zPW.js";import"./CtxRJYhM.js";import"./DZiD_n4a.js";import"./8F3V6at2.js";import"./B1BtpM6Q.js";import"./BPEFIfMV.js";import"./ChOKVcqp.js";import"./CqMkjHLC.js";import"./CHIgUVhi.js";import"./Bk27txv5.js";import"./-VWu3lWq.js";import"./DWe5xPtV.js";import"./DxI7QMRn.js";import"./mUUuLyVv.js";import"./CbhVS3Xc.js";import"./Be7d-GBD.js";import"./Bt2YpT3E.js";import"./HiGXOwLp.js";import"./gy6MXjwN.js";import"./ChAwXecA.js";import"./DDBjNozI.js";import"./CeAEZXwI.js";import"./BH030lJW.js";import"./Be3VPoHw.js";import"./BUV3okvS.js";const le={class:"space-y-3"},re={class:"flex justify-between items-center"},se={class:"bg-white rounded-lg shadow border p-6"},ue={key:0,class:"mt-2"},ie=["src"],ce={class:"py-4"},de={class:"font-semibold text-red-500"},me=S({__name:"index",setup(pe){const c=V(),p=f(!1),g=f(!1),y=f(null),s=f(null),h=f(!1),o=f({bank_name:"",account_name:"",account_number:"",branch:"",qr_image:null,status:!0}),q={bank_name:{required:!0,message:"Please input bank name",trigger:"blur"},account_name:{required:!0,message:"Please input account holder name",trigger:"blur"},account_number:{required:!0,message:"Please input account number",trigger:"blur"}},N=[{accessorKey:"bank_name",header:"Bank Name"},{accessorKey:"account_name",header:"Account Name"},{accessorKey:"account_number",header:"Account Number"},{accessorKey:"branch",header:"Branch"},{accessorKey:"qr_image",header:"QR Code",cell:({row:a})=>a.original.qr_image?b("img",{src:a.original.qr_image,alt:"QR Code",style:"width: 50px; height: 50px; border-radius: 6px; border: 1px solid #eee; background: #fafbfc;"}):"-"},{accessorKey:"status",header:"Status",cell:({row:a})=>a.original.status?"Active":"Inactive"},{id:"actions",header:"Actions",cell:({row:a})=>b("div",{class:"flex gap-2"},[b(ne,{class:"w-4 h-4 text-blue-600 cursor-pointer hover:scale-110 transition",onClick:()=>U(a.original)}),b(oe,{class:"w-4 h-4 text-red-600 cursor-pointer hover:scale-110 transition",onClick:()=>F(a.original)})])}],u=G(async a=>{try{return(await k.get("/api/bank",{params:a})).data||[]}catch(e){return console.error("Error fetching bank accounts:",e),c.error("Failed to load bank accounts"),[]}}),D=a=>{const{file:e}=a;if(e.file){const r=new FileReader;r.onload=_=>{o.value.qr_image=_.target.result},r.readAsDataURL(e.file)}},E=()=>{s.value=null,w(),p.value=!0},R=()=>{var a;(a=y.value)==null||a.validate(async e=>{if(!e)try{h.value=!0;let r;s.value?r=await k.put(`/api/bank/${s.value._id}`,o.value):r=await k.post("/api/bank",o.value),r.status?(await u.reload(),c.success(s.value?"Bank account updated successfully":"Bank account added successfully"),p.value=!1,w()):c.error(r.message||"Failed to save bank account")}catch(r){console.error("Error saving bank account:",r),c.error("Failed to save bank account")}finally{h.value=!1}})},U=a=>{s.value=a,o.value={...a},p.value=!0},F=a=>{s.value=a,g.value=!0},K=async()=>{if(s.value)try{const a=await k.delete(`/api/bank/${s.value._id}`);a.status?(await u.reload(),c.success("Bank account deleted successfully")):c.error(a.message||"Failed to delete bank account")}catch(a){console.error("Error deleting bank account:",a),c.error("Failed to delete bank account")}finally{g.value=!1,s.value=null}},w=()=>{o.value={bank_name:"",account_name:"",account_number:"",branch:"",qr_image:null,status:!0}};return T(()=>{u.fetchData()}),(a,e)=>{const r=H,_=Y,d=X,$=Z,x=ae,B=te,I=ee,Q=W,C=J;return P(),A("div",le,[v("div",re,[e[10]||(e[10]=v("h1",{class:"text-2xl font-bold"},"Bank List",-1)),t(r,{type:"primary",class:"!bg-blue-600 hover:!bg-blue-700 text-white font-semibold",onClick:E},{icon:n(()=>[t(m(O))]),default:n(()=>[e[9]||(e[9]=i(" Add Bank "))]),_:1,__:[9]})]),t(L,{columns:N,data:m(u).data,loading:m(u).loading,page:m(u).pagination.page,size:m(u).pagination.limit,total:m(u).pagination.total,onChangePage:m(u).handlePageChange,filterKey:"bank_name"},null,8,["data","loading","page","size","total","onChangePage"]),t(C,{show:p.value,"onUpdate:show":e[6]||(e[6]=l=>p.value=l),preset:"card",style:{width:"500px"},title:s.value?"Edit Bank Account":"Add Bank Account"},{default:n(()=>[v("div",se,[t(Q,{ref_key:"formRef",ref:y,model:o.value,rules:q,"label-placement":"top","label-width":"auto","require-mark-placement":"right-hanging"},{default:n(()=>[t(d,{label:"Bank Name",path:"bank_name"},{default:n(()=>[t(_,{value:o.value.bank_name,"onUpdate:value":e[0]||(e[0]=l=>o.value.bank_name=l),placeholder:"Enter bank name"},null,8,["value"])]),_:1}),t(d,{label:"Account Name",path:"account_name"},{default:n(()=>[t(_,{value:o.value.account_name,"onUpdate:value":e[1]||(e[1]=l=>o.value.account_name=l),placeholder:"Enter account holder name"},null,8,["value"])]),_:1}),t(d,{label:"Account Number",path:"account_number"},{default:n(()=>[t(_,{value:o.value.account_number,"onUpdate:value":e[2]||(e[2]=l=>o.value.account_number=l),placeholder:"Enter account number"},null,8,["value"])]),_:1}),t(d,{label:"Branch",path:"branch"},{default:n(()=>[t(_,{value:o.value.branch,"onUpdate:value":e[3]||(e[3]=l=>o.value.branch=l),placeholder:"Enter branch name"},null,8,["value"])]),_:1}),t(d,{label:"QR Code Image",path:"qr_image"},{default:n(()=>[t($,{"default-upload":!1,max:1,"list-type":"image-card","on-change":D},{default:n(()=>e[11]||(e[11]=[i(" Upload QR Code ")])),_:1,__:[11]}),o.value.qr_image?(P(),A("div",ue,[v("img",{src:o.value.qr_image,alt:"QR Code Preview",class:"w-32 h-32 object-contain border border-gray-200 rounded"},null,8,ie)])):j("",!0)]),_:1}),t(d,{label:"Status",path:"status"},{default:n(()=>[t(I,{value:o.value.status,"onUpdate:value":e[4]||(e[4]=l=>o.value.status=l)},{default:n(()=>[t(B,null,{default:n(()=>[t(x,{value:!0},{default:n(()=>e[12]||(e[12]=[i("Active")])),_:1,__:[12]}),t(x,{value:!1},{default:n(()=>e[13]||(e[13]=[i("Inactive")])),_:1,__:[13]})]),_:1})]),_:1},8,["value"])]),_:1}),t(d,null,{default:n(()=>[t(B,{justify:"end"},{default:n(()=>[t(r,{onClick:e[5]||(e[5]=l=>p.value=!1)},{default:n(()=>e[14]||(e[14]=[i("Cancel")])),_:1,__:[14]}),t(r,{type:"primary",class:"!bg-blue-600 hover:!bg-blue-700 text-white font-semibold",onClick:R,loading:h.value},{default:n(()=>e[15]||(e[15]=[i("Save")])),_:1,__:[15]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["show","title"]),t(C,{show:g.value,"onUpdate:show":e[7]||(e[7]=l=>g.value=l),preset:"dialog",type:"error",title:"Confirm Delete","positive-text":"Delete","negative-text":"Cancel",onPositiveClick:K,onNegativeClick:e[8]||(e[8]=l=>g.value=!1)},{default:n(()=>{var l;return[v("div",ce,[e[16]||(e[16]=i(" Are you sure you want to delete bank account ")),v("span",de,M((l=s.value)==null?void 0:l.bank_name),1),e[17]||(e[17]=i("? "))])]}),_:1},8,["show"])])}}}),aa=z(me,[["__scopeId","data-v-31367fb3"]]);export{aa as default};
