import{P as T,a_ as V,r as b,a as x,ad as j,h as a,g as t,i as B,t as s,F as I,j as E,aU as F,o as n}from"./CKxg9VfS.js";const P={class:"w-full bg-background text-foreground min-h-screen"},A={key:0,class:"flex justify-center items-center p-10"},C={key:1,class:"p-6 bg-destructive/10 border border-destructive/20 m-4 rounded"},q={class:"text-destructive"},M={key:2,class:"p-4 space-y-4"},S={class:"bg-card text-card-foreground rounded border border-border shadow-sm p-6"},L={class:"grid grid-cols-2 md:grid-cols-4 gap-6"},Q={class:"font-medium"},R={class:"font-medium"},U={class:"font-medium"},$={class:"font-medium capitalize"},z={class:"bg-card text-card-foreground rounded border border-border shadow-sm"},G={class:"overflow-x-auto"},H={class:"w-full"},J={class:"py-3 px-4"},K={class:"py-3 px-4"},O={class:"py-3 px-4"},W={class:"py-3 px-4"},X={class:"py-3 px-4 text-right"},Y={class:"py-3 px-4 text-right"},Z={class:"py-3 px-4 text-right"},tt={class:"py-3 px-4 text-right"},et={class:"py-3 px-4 text-right"},rt={class:"py-3 px-4 text-right font-medium"},st={class:"bg-card text-card-foreground rounded border border-border shadow-sm p-6"},ot={class:"flex justify-end"},dt={class:"w-64"},at={class:"flex justify-between py-2"},nt={class:"flex justify-between py-2"},lt={class:"flex justify-between py-2"},it={class:"text-primary font-bold"},ut={__name:"[id]",setup(ct){const w=V(),k=F(),D=w.params.id,o=b(null),c=b(!0),i=b(null),l=r=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(r),m=r=>{const e=new Date(r);return new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},p=r=>(r.supplier_price||0)*(r.unit_quantity||0),v=x(()=>o.value?o.value.items.reduce((r,e)=>r+p(e),0):0),y=x(()=>o.value?o.value.items.reduce((r,e)=>{const u=p(e);return r+u*(e.vat||0)/100},0):0),N=x(()=>v.value+y.value),f=async()=>{c.value=!0,i.value=null;try{const r=await fetch(`/api/purchase/${D}`);if(!r.ok)throw new Error(`Error: ${r.status}`);const e=await r.json();if(e.status&&e.data)o.value=e.data;else throw new Error(e.message||"Failed to fetch purchase details")}catch(r){i.value=r.message,console.error("Error fetching purchase details:",r)}finally{c.value=!1}},h=()=>{k.push("/purchase")};return j(f),(r,e)=>{var u;return n(),a("div",P,[t("div",{class:"flex items-center justify-between p-4 border-b border-border"},[t("div",{class:"flex items-center gap-2"},[t("button",{onClick:h,class:"text-primary hover:text-primary/80"}," ← "),e[0]||(e[0]=t("h1",{class:"text-xl text-primary font-bold"},"Purchase Details",-1))]),t("button",{onClick:h,class:"px-4 py-2 border border-border rounded text-sm hover:bg-muted transition-colors"}," Back to List ")]),c.value?(n(),a("div",A,e[1]||(e[1]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary"},null,-1)]))):i.value?(n(),a("div",C,[e[2]||(e[2]=t("h3",{class:"text-lg font-bold text-destructive"},"Error",-1)),t("p",q,s(i.value),1),t("button",{onClick:f,class:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors"}," Try Again ")])):o.value?(n(),a("div",M,[t("div",S,[t("div",L,[t("div",null,[e[3]||(e[3]=t("div",{class:"text-muted-foreground text-sm"},"Invoice No",-1)),t("div",Q,s(o.value.invoice_no),1)]),t("div",null,[e[4]||(e[4]=t("div",{class:"text-muted-foreground text-sm"},"Date",-1)),t("div",R,s(m(o.value.date)),1)]),t("div",null,[e[5]||(e[5]=t("div",{class:"text-muted-foreground text-sm"},"Supplier",-1)),t("div",U,s(((u=o.value.supplier)==null?void 0:u.name)||"N/A"),1)]),t("div",null,[e[6]||(e[6]=t("div",{class:"text-muted-foreground text-sm"},"Payment Type",-1)),t("div",$,s(o.value.payment_type),1)])])]),t("div",z,[e[8]||(e[8]=t("div",{class:"p-4 border-b border-border"},[t("h2",{class:"font-medium"},"Medicine Items")],-1)),t("div",G,[t("table",H,[e[7]||(e[7]=t("thead",null,[t("tr",{class:"bg-muted/50 text-muted-foreground"},[t("th",{class:"py-3 px-4 text-left border-b border-border"},"#"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Medicine"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Batch ID"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Expiry Date"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Box Pattern"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Box Qty"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Unit Qty"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Price"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"VAT (%)"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Total")])],-1)),t("tbody",null,[(n(!0),a(I,null,E(o.value.items,(d,_)=>{var g;return n(),a("tr",{key:_,class:"border-b border-border hover:bg-muted/50 transition-colors"},[t("td",J,s(_+1),1),t("td",K,s(((g=d.medicine)==null?void 0:g.name)||"N/A"),1),t("td",O,s(d.batch_id),1),t("td",W,s(m(d.expiry_date)),1),t("td",X,s(d.box_pattern),1),t("td",Y,s(d.box_quantity),1),t("td",Z,s(d.unit_quantity),1),t("td",tt,s(l(d.supplier_price)),1),t("td",et,s(d.vat||0)+"%",1),t("td",rt,s(l(p(d))),1)])}),128))])])])]),t("div",st,[t("div",ot,[t("div",dt,[t("div",at,[e[9]||(e[9]=t("span",{class:"text-muted-foreground"},"Subtotal:",-1)),t("span",null,s(l(v.value)),1)]),t("div",nt,[e[10]||(e[10]=t("span",{class:"text-muted-foreground"},"VAT:",-1)),t("span",null,s(l(y.value)),1)]),e[12]||(e[12]=t("div",{class:"h-px bg-border my-2"},null,-1)),t("div",lt,[e[11]||(e[11]=t("span",{class:"text-primary font-bold"},"Total:",-1)),t("span",it,s(l(N.value)),1)])])])])])):B("",!0)])}}},bt=T(ut,[["__scopeId","data-v-1f9b671e"]]);export{bt as default};
