import{d as H,aI as I,r as y,a0 as b,a as X,ad as L,h as M,g as d,e as a,w as s,u as r,y as O,o as G,k as p,b3 as J,t as Q}from"./CKxg9VfS.js";import{c as R,_ as W,a as Y,b as Z}from"./y658cYhg.js";import{_ as ee}from"./B8pS-BuA.js";import{u as te,t as ae}from"./BCSPHuIH.js";import{_ as oe}from"./tYwaLfcc.js";import{o as $,p as N,s as i,n as V,e as se}from"./FxXfjA_C.js";import{u as ne}from"./Bpf85daN.js";import{a as v}from"./Bjtksisr.js";import{P as ie}from"./CZYgztcZ.js";import{T as le}from"./HXfFxbHn.js";import"./B1BtpM6Q.js";import"./fc2ftCRW.js";import"./CHIgUVhi.js";import"./CqMkjHLC.js";import"./DS3w2pYu.js";import"./BCknCIeb.js";import"./DZiD_n4a.js";import"./-VWu3lWq.js";import"./CdaYbVMG.js";import"./mqphGkif.js";import"./C6uedsDB.js";import"./CNZ14BIZ.js";import"./BE8kfJko.js";import"./DP3_pcoO.js";import"./BPEFIfMV.js";import"./ChOKVcqp.js";import"./BWQRRhWv.js";import"./CNC5rzjO.js";import"./8F3V6at2.js";import"./Bk27txv5.js";import"./DWe5xPtV.js";import"./BLmtRsFP.js";import"./DZHg-zPW.js";import"./CtxRJYhM.js";import"./DxI7QMRn.js";$({_id:i(),name:i().min(1,"Name is required"),address:i().optional(),phone:i().optional(),mail:i().optional(),city:i().optional(),country:i().optional(),balance:N(u=>u!==""?Number(u):0,V().min(0,"Balance must be positive").optional())});const S=$({name:i().min(1,"Name is required"),address:i().optional(),phone:i().optional(),mail:i().optional(),city:i().optional(),country:se(["Vietnam","Other"]).optional(),balance:N(u=>u!==""?Number(u):0,V().min(0,"Balance must be positive").optional())}),re={class:"w-full flex flex-col items-stretch gap-4"},pe={class:"flex flex-wrap items-end justify-between gap-2"},me={class:"col-span-3 flex justify-center items-center mt-4"},ue={class:"font-semibold text-red-500"},de={class:"flex justify-end gap-2 mt-4"},Qe=H({__name:"index",setup(u){const{toast:h}=I(),k=y([{accessorKey:"stt",header:"STT"},{accessorKey:"name",header:"Name"},{accessorKey:"mail",header:"Email"},{accessorKey:"phone",header:"Phone"},{accessorKey:"address",header:"Address"},{accessorKey:"city",header:"City"},{accessorKey:"balance",header:"Balance ($)",cell:({row:t})=>{var o;const e=((o=t==null?void 0:t.original)==null?void 0:o.balance)??0;return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}},{accessorKey:"actions",header:"Actions",cell:({row:t})=>{const e=t.original;return b("div",{class:"flex gap-2"},[b(ie,{class:"w-4 h-4 text-blue-600 cursor-pointer hover:scale-110 transition",onClick:()=>U(e)}),b(le,{class:"w-4 h-4 text-red-600 cursor-pointer hover:scale-110 transition",onClick:()=>F(e)})])}}]),{data:A,loading:ce,pagination:m,fetchData:g,handlePageChange:K}=ne(async({page:t,limit:e})=>{const o=await v.get("/api/suppliers",{params:{page:t,limit:e}});return m.total=o.total??0,o.data}),B=X(()=>A.value);L(g);const c=y(!1),P=ae(S),f=y(!1),l=y(null),_=te({validationSchema:P,initialValues:{name:"",phone:"",mail:"",address:"",city:"",country:"Vietnam",balance:0}}),U=t=>{l.value=t,_.setValues(t),c.value=!0},j=async()=>{if(!l.value)return;(await v.delete(`/api/suppliers/${l.value._id}`)).status&&(h({title:"Xoá thành công"}),await g()),f.value=!1,l.value=null},F=t=>{l.value=t,f.value=!0},z=()=>{l.value=null,_.resetForm({values:{name:"",phone:"",mail:"",address:"",city:"",country:"Vietnam",balance:0}}),c.value=!0},E=_.handleSubmit(async t=>{const e={...t};let o;l.value?o=await v.put(`/api/suppliers/${l.value._id}`,e):o=await v.post("/api/suppliers",e),o.status&&(h({title:l.value?"Update success":"Add success"}),await g()),c.value=!1,l.value=null,_.resetForm()});return(t,e)=>{const o=O,x=Z,w=J,D=Y,q=ee,T=W,C=R;return G(),M("div",re,[d("div",pe,[e[7]||(e[7]=d("div",{class:"flex justify-between"},[d("h2",{class:"text-2xl font-bold tracking-tight"},"Supplier List")],-1)),a(o,{onClick:z},{default:s(()=>e[6]||(e[6]=[p(" Add ")])),_:1,__:[6]})]),a(oe,{data:r(B),columns:k.value,filterKey:"name",page:r(m).page,"onUpdate:page":e[0]||(e[0]=n=>r(m).page=n),onChangePage:r(K),size:r(m).limit,"onUpdate:size":e[1]||(e[1]=n=>r(m).limit=n),total:r(m).total,"onUpdate:total":e[2]||(e[2]=n=>r(m).total=n)},null,8,["data","columns","page","onChangePage","size","total"]),a(C,{open:c.value,"onUpdate:open":e[3]||(e[3]=n=>c.value=n)},{default:s(()=>[a(T,null,{default:s(()=>[a(D,null,{default:s(()=>[a(x,null,{default:s(()=>e[8]||(e[8]=[p(" Add Supplier")])),_:1,__:[8]}),a(w,{class:"text-xs text-muted-foreground"})]),_:1}),a(q,{class:"grid grid-cols-2 gap-2",form:r(_),schema:r(S),onSubmit:r(E)},{default:s(()=>[d("div",me,[a(o,{type:"submit"},{default:s(()=>e[9]||(e[9]=[p(" Save ")])),_:1,__:[9]})])]),_:1},8,["form","schema","onSubmit"])]),_:1})]),_:1},8,["open"]),a(C,{open:f.value,"onUpdate:open":e[5]||(e[5]=n=>f.value=n)},{default:s(()=>[a(T,null,{default:s(()=>[a(D,null,{default:s(()=>[a(x,null,{default:s(()=>e[10]||(e[10]=[p("Confirm delete")])),_:1,__:[10]}),a(w,null,{default:s(()=>{var n;return[e[11]||(e[11]=p(" Are you sure you want to delete ")),d("span",ue,Q((n=l.value)==null?void 0:n.name),1),e[12]||(e[12]=p(" ? "))]}),_:1,__:[11,12]})]),_:1}),d("div",de,[a(o,{variant:"ghost",onClick:e[4]||(e[4]=n=>f.value=!1)},{default:s(()=>e[13]||(e[13]=[p("Huỷ")])),_:1,__:[13]}),a(o,{variant:"destructive",onClick:j},{default:s(()=>e[14]||(e[14]=[p("Xoá")])),_:1,__:[14]})])]),_:1})]),_:1},8,["open"])])}}});export{Qe as default};
