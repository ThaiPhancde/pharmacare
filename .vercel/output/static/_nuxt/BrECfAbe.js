import{ft as r,aY as i,aZ as a,bA as o}from"./CKxg9VfS.js";const n=r(s=>{const t=i("userInfo");if(!t.value)return a("/login");try{const e=JSON.parse(t.value);if(s.path.startsWith("/admin")&&e.role!=="admin")throw o({statusCode:403,statusMessage:"You don't have permission to access this page"});if((s.path.startsWith("/stock")||s.path.startsWith("/purchase"))&&!["admin","warehouse"].includes(e.role))throw o({statusCode:403,statusMessage:"You don't have permission to access this page"})}catch{return a("/login")}});export{n as default};
