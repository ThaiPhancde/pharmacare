import{P as I,a_ as j,r as u,a as C,ad as N,h as n,g as t,i as _,t as o,F as V,j as E,aU as F,o as i}from"./CKxg9VfS.js";const B={class:"w-full bg-background text-foreground min-h-screen"},P={key:0,class:"flex justify-center items-center p-10"},T={key:1,class:"p-6 bg-destructive/10 border border-destructive/20 m-4 rounded"},$={class:"text-destructive"},A={key:2,class:"p-4 space-y-4"},S={class:"bg-card text-card-foreground rounded border border-border shadow-sm p-6"},M={class:"grid grid-cols-2 md:grid-cols-4 gap-6"},U={class:"font-medium"},R={class:"font-medium"},z={class:"font-medium"},L={class:"font-medium capitalize"},O={class:"bg-card text-card-foreground rounded border border-border shadow-sm"},q={class:"overflow-x-auto"},G={class:"w-full"},H={class:"py-3 px-4"},Q={class:"py-3 px-4"},W={class:"py-3 px-4"},J={class:"py-3 px-4"},K={class:"py-3 px-4 text-right"},X={class:"py-3 px-4 text-right"},Y={class:"py-3 px-4 text-right"},Z={class:"py-3 px-4 text-right font-medium"},tt={class:"bg-card text-card-foreground rounded border border-border shadow-sm p-6"},et={class:"flex justify-end"},st={class:"w-64"},ot={class:"flex justify-between py-2"},rt={class:"flex justify-between py-2"},dt={class:"flex justify-between py-2"},at={class:"flex justify-between py-2"},nt={class:"text-primary font-bold"},it={class:"flex justify-between py-2"},lt={class:"flex justify-between py-2"},ut={key:0,class:"bg-green-50 text-green-800 rounded border border-green-200 shadow-sm p-4 text-center"},ct={__name:"[id]",setup(pt){const h=j(),m=F(),w=h.params.id,c=u(decodeURIComponent(w).replace(/\s+/g,"-").toUpperCase()),s=u(null),p=u(!0),l=u(null),d=r=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(r),b=r=>{const e=new Date(r);return new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},k=C(()=>{if(!s.value)return"";let r=s.value.payment_method?s.value.payment_method.toUpperCase():"";return s.value.payment_method==="cash"&&s.value.payment_details&&s.value.payment_details.change>0&&(r+=` (Change: ${d(s.value.payment_details.change)})`),s.value.payment_method==="card"&&s.value.payment_details&&s.value.payment_details.card_number&&(r+=` (${s.value.payment_details.card_number})`),r}),v=async()=>{p.value=!0,l.value=null;try{console.log(`Fetching invoice with normalized ID: ${c.value}`);const r=await fetch(`/api/invoice/${c.value}`);if(!r.ok)throw new Error(`Error: ${r.status}`);const e=await r.json();if(e.status&&e.data)s.value=e.data;else throw new Error(e.message||"Failed to fetch invoice details")}catch(r){l.value=r.message,console.error("Error fetching invoice details:",r)}finally{p.value=!1}},x=()=>{m.push("/invoice")},D=()=>{m.push(`/invoice/shipping/${c.value}`)};return N(v),(r,e)=>{var y;return i(),n("div",B,[t("div",{class:"flex items-center justify-between p-4 border-b border-border"},[t("div",{class:"flex items-center gap-2"},[t("button",{onClick:x,class:"text-primary hover:text-primary/80"}," ← "),e[0]||(e[0]=t("h1",{class:"text-xl text-primary font-bold"},"Invoice Details",-1))]),t("button",{onClick:x,class:"px-4 py-2 border border-border rounded text-sm hover:bg-muted transition-colors"}," Back to List ")]),p.value?(i(),n("div",P,e[1]||(e[1]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary"},null,-1)]))):l.value?(i(),n("div",T,[e[2]||(e[2]=t("h3",{class:"text-lg font-bold text-destructive"},"Error",-1)),t("p",$,o(l.value),1),t("button",{onClick:v,class:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors"}," Try Again ")])):s.value?(i(),n("div",A,[t("div",S,[t("div",M,[t("div",null,[e[3]||(e[3]=t("div",{class:"text-muted-foreground text-sm"},"Invoice No",-1)),t("div",U,o(s.value.invoice_no||"N/A"),1)]),t("div",null,[e[4]||(e[4]=t("div",{class:"text-muted-foreground text-sm"},"Date",-1)),t("div",R,o(b(s.value.date)),1)]),t("div",null,[e[5]||(e[5]=t("div",{class:"text-muted-foreground text-sm"},"Customer",-1)),t("div",z,o(((y=s.value.customer)==null?void 0:y.full_name)||"Walk-in Customer"),1)]),t("div",null,[e[6]||(e[6]=t("div",{class:"text-muted-foreground text-sm"},"Payment Method",-1)),t("div",L,o(k.value),1)])]),t("div",{class:"mt-4 flex justify-end"},[t("button",{onClick:D,class:"px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors"}," Ship Order (GHN) ")])]),t("div",O,[e[8]||(e[8]=t("div",{class:"p-4 border-b border-border"},[t("h2",{class:"font-medium"},"Medicine Items")],-1)),t("div",q,[t("table",G,[e[7]||(e[7]=t("thead",null,[t("tr",{class:"bg-muted/50 text-muted-foreground"},[t("th",{class:"py-3 px-4 text-left border-b border-border"},"#"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Medicine"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Batch ID"),t("th",{class:"py-3 px-4 text-left border-b border-border"},"Expiry Date"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Quantity"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Price"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"VAT (%)"),t("th",{class:"py-3 px-4 text-right border-b border-border"},"Total")])],-1)),t("tbody",null,[(i(!0),n(V,null,E(s.value.items,(a,f)=>{var g;return i(),n("tr",{key:f,class:"border-b border-border hover:bg-muted/50 transition-colors"},[t("td",H,o(f+1),1),t("td",Q,o(((g=a.medicine)==null?void 0:g.name)||"N/A"),1),t("td",W,o(a.batch_id),1),t("td",J,o(b(a.expiry_date)),1),t("td",K,o(a.quantity),1),t("td",X,o(d(a.price)),1),t("td",Y,o(a.vat||0)+"%",1),t("td",Z,o(d(a.subtotal)),1)])}),128))])])])]),t("div",tt,[t("div",et,[t("div",st,[t("div",ot,[e[9]||(e[9]=t("span",{class:"text-muted-foreground"},"Subtotal:",-1)),t("span",null,o(d(s.value.subtotal)),1)]),t("div",rt,[e[10]||(e[10]=t("span",{class:"text-muted-foreground"},"VAT:",-1)),t("span",null,o(d(s.value.vat_total)),1)]),t("div",dt,[e[11]||(e[11]=t("span",{class:"text-muted-foreground"},"Discount:",-1)),t("span",null,o(d(s.value.discount)),1)]),e[15]||(e[15]=t("div",{class:"h-px bg-border my-2"},null,-1)),t("div",at,[e[12]||(e[12]=t("span",{class:"text-primary font-bold"},"Total:",-1)),t("span",nt,o(d(s.value.grand_total)),1)]),t("div",it,[e[13]||(e[13]=t("span",{class:"text-muted-foreground"},"Paid:",-1)),t("span",null,o(d(s.value.paid)),1)]),t("div",lt,[e[14]||(e[14]=t("span",{class:"text-muted-foreground"},"Due:",-1)),t("span",null,o(d(s.value.due)),1)])])])]),s.value.is_pos?(i(),n("div",ut,e[16]||(e[16]=[t("span",{class:"font-medium"},"POS Invoice",-1)]))):_("",!0)])):_("",!0)])}}},bt=I(ct,[["__scopeId","data-v-c7c9e152"]]);export{bt as default};
