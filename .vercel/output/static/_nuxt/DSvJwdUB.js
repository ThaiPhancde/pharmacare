import{aV as we,r as p,a as I,ad as Ce,h as v,g as a,e as i,w as _,F as N,j as K,b as O,i as S,o as c,k as P,t as u,n as ne,u as Me}from"./CKxg9VfS.js";import{a as D}from"./Bjtksisr.js";import{B as Pe}from"./BB3-CH1i.js";import{s as qe}from"./x_rD_Ya3.js";import{u as De}from"./B9Nuy0Yo.js";import{B as Ae}from"./CkclNe_0.js";import{T as $e}from"./HXfFxbHn.js";import{_ as Se}from"./BjNiWSUp.js";import{_ as je}from"./Bt2YpT3E.js";import{_ as Ie}from"./DpFlcqSt.js";import{_ as Ne}from"./C_IQnCrB.js";import{_ as Ue}from"./BHMcXTSu.js";import{_ as Te}from"./BpvOLQCW.js";import"./mUUuLyVv.js";import"./CbhVS3Xc.js";import"./Be7d-GBD.js";import"./HiGXOwLp.js";import"./ChAwXecA.js";import"./DDBjNozI.js";import"./Be3VPoHw.js";import"./gy6MXjwN.js";import"./BH030lJW.js";import"./DboHdRIr.js";import"./CMIqKt_m.js";import"./BUV3okvS.js";const ze=we("/momo-icon.svg"),Ve={class:"flex flex-col md:flex-row h-screen gap-4 p-4"},Be={class:"w-full md:w-2/3 flex flex-col gap-4"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ye={class:"relative"},Ee={class:"flex gap-2 overflow-x-auto pb-2"},Re={key:0,class:"flex justify-center items-center h-full"},Qe={key:1,class:"flex justify-center items-center h-full text-gray-500"},Le={key:2,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},Oe={class:"aspect-square bg-gray-100 rounded-md mb-2 flex items-center justify-center overflow-hidden"},We=["src","alt"],Xe={class:"font-medium text-sm leading-tight mb-1 truncate"},Ge={class:"flex justify-between items-center"},He={class:"text-xs text-gray-500"},Je={class:"text-xs font-semibold"},Ke={class:"flex justify-between items-center mt-1"},Ze={class:"w-full md:w-1/3 flex flex-col gap-4"},et={key:0,class:"flex justify-center items-center h-32 text-gray-500"},tt={key:1,class:"space-y-3"},at={class:"flex items-center justify-between"},st={class:"flex-1"},lt={class:"font-medium text-sm"},nt={class:"text-xs text-gray-500"},ot={class:"text-xs text-amber-600"},rt={key:0,class:"text-xs text-green-600"},it={class:"line-through text-gray-500 ml-1"},ut={class:"flex items-center gap-2"},ct={class:"font-semibold"},dt={class:"flex justify-between items-center"},pt={class:"flex justify-between items-center"},vt={class:"flex justify-between items-center"},mt={class:"flex items-center gap-2"},ft={class:"flex justify-between items-center font-bold"},_t={class:"flex justify-between items-center"},yt={class:"flex justify-between items-center"},gt={key:0,class:"flex justify-between items-center font-bold text-green-600"},bt={class:"border border-gray-200 rounded p-4 bg-gray-50"},xt={class:"flex flex-col gap-2"},ht={class:"flex items-center"},kt={class:"flex items-center"},wt={class:"flex items-center"},Ct={class:"flex gap-1"},Mt={class:"flex items-center"},Pt={class:"flex justify-between items-center mt-2"},qt={class:"font-bold"},Dt={class:"border border-gray-200 rounded p-4 bg-gray-50 flex flex-col items-center"},At={class:"bg-white p-3 rounded shadow-sm mb-4"},$t={class:"flex justify-center mb-2"},St=["src"],jt={class:"w-full"},It={class:"flex justify-between py-2 border-b"},Nt={class:"flex justify-between py-2 border-b"},Ut={class:"flex justify-between py-2 border-b"},Tt={class:"font-bold"},zt={key:3,class:"border border-gray-200 rounded p-4 bg-gray-50 flex flex-col items-center"},Vt={key:0,class:"bg-white p-3 rounded shadow-sm mb-4"},Bt={class:"flex justify-center mb-2"},Ft=["src"],Yt={key:1,class:"w-48 h-48 bg-gray-200 flex items-center justify-center"},Et={class:"text-center mt-2"},Rt={class:"text-sm text-gray-600"},Qt={class:"w-full"},Lt={class:"flex justify-between py-2 border-b"},Ot={class:"font-bold text-pink-600"},Wt={class:"flex justify-between py-2"},Xt={class:"text-sm"},Gt={class:"flex gap-2 w-full mt-4"},Ht={key:1,class:"mt-3 p-2 bg-blue-50 rounded text-xs text-blue-600"},Jt={class:"flex gap-2"},Ca={__name:"pos",setup(Kt){const o=De(),W=p(!1),E=p(""),U=p("all"),Z=p([{id:"all",name:"All"},{id:"Antibiotics",name:"Antibiotics"},{id:"Painkillers",name:"Pain killers"},{id:"Antipyretics",name:"Antipyretics"},{id:"Vitamins",name:"Vitamins"}]),T=p([]),ee=p([]),z=p(null),m=p([]),A=p(0),y=p("cash"),w=p(0),r=p({name:"",number:"",expMonth:"",expYear:"",cvv:""}),oe=p([{label:"4012888888881881 (Visa)",value:"4012888888881881"},{label:"5555555555554444 (Mastercard)",value:"5555555555554444"},{label:"371449635398431 (Amex)",value:"371449635398431"},{label:"376680816376961 (Amex)",value:"376680816376961"},{label:"36259600000004 (Diners)",value:"36259600000004"},{label:"6304000000000000 (Maestro)",value:"6304000000000000"},{label:"5063516945005047 (Maestro)",value:"5063516945005047"}]),re=p([{label:"01",value:"01"},{label:"02",value:"02"},{label:"03",value:"03"},{label:"04",value:"04"},{label:"05",value:"05"},{label:"06",value:"06"},{label:"07",value:"07"},{label:"08",value:"08"},{label:"09",value:"09"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"}]),ie=p([{label:"2024",value:"2024"},{label:"2025",value:"2025"},{label:"2026",value:"2026"},{label:"2027",value:"2027"},{label:"2028",value:"2028"},{label:"2029",value:"2029"},{label:"2030",value:"2030"}]),R=p(null),q=p(null),X=p(null),C=p(null),j=p("Pending"),Q=p(!1),x=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(t),te=I(()=>{let t=T.value;if(E.value){const e=E.value.toLowerCase();t=t.filter(l=>{var s;return l.name.toLowerCase().includes(e)||((s=l.category)==null?void 0:s.name.toLowerCase().includes(e))})}return U.value!=="all"&&(t=t.filter(e=>{var l;return((l=e.category)==null?void 0:l.name)===U.value})),t}),V=I(()=>m.value.reduce((t,e)=>t+e.price*e.quantity,0)),B=I(()=>m.value.reduce((t,e)=>{const l=e.price*e.quantity;return t+l*(e.vat||10)/100},0)),g=I(()=>V.value+B.value-A.value),ae=I(()=>Math.max(0,Number(w.value)-g.value)),ue=I(()=>m.value.length===0?!1:y.value==="cash"?Number(w.value)>=g.value:!0),ce=t=>{U.value=t},se=t=>{if(console.log("Adding medicine to cart:",t),!t.stocks||t.stocks.length===0){console.warn(`${t.name} has no stocks:`,t.stocks),o.error(`${t.name} is out of stock`);return}const e=t.stocks.filter(d=>d.unit_quantity>0&&new Date(d.expiry_date)>new Date);if(console.log("Valid stocks found:",e.length),e.length===0){o.error(`${t.name} is out of stock or expired`);return}e.sort((d,ke)=>new Date(d.expiry_date)-new Date(ke.expiry_date));const l=e[0],s=new Date,L=new Date(l.expiry_date).getTime()-s.getTime(),M=Math.ceil(L/(1e3*60*60*24));let b=0,$="";M<=7?(b=50,$="Critical expiry (≤ 7 days)"):M<=30&&(b=20,$="Warning expiry (≤ 30 days)");const n=l.mrp||t.price||0,h=b>0?Math.round(n*(1-b/100)):n,k=m.value.find(d=>d._id===t._id&&d.batch_id===l.batch_id);if(k)k.quantity<k.max_quantity?(k.quantity+=1,l.unit_quantity-=1,o.success(`Added ${t.name} to cart`),b>0&&o.info(`${$}: ${b}% discount applied`)):o.warning(`Cannot add more. Only ${k.max_quantity} ${t.name} available in batch ${l.batch_id}`);else{const d=l.unit_quantity;l.unit_quantity-=1,m.value.push({_id:t._id,name:t.name,original_price:n,price:h,discount_percentage:b,discount_reason:$,vat:l.vat||10,quantity:1,batch_id:l.batch_id,expiry_date:l.expiry_date,max_quantity:d,stock_id:l._id,purchase:l.purchase,days_left:M}),o.success(`Added ${t.name} to cart`),b>0&&o.info(`${$}: ${b}% discount applied`)}},de=t=>{const e=m.value[t];if(e){const l=T.value.find(s=>s._id===e._id);if(l){const s=l.stocks.find(f=>f._id===e.stock_id);s&&(s.unit_quantity+=e.quantity,console.log(`Restored ${e.quantity} units to stock of ${e.name}`))}}m.value.splice(t,1)},G=()=>{m.value.forEach(t=>{const e=T.value.find(l=>l._id===t._id);if(e){const l=e.stocks.find(s=>s._id===t.stock_id);l&&(l.unit_quantity+=t.quantity,console.log(`Restored ${t.quantity} units to stock of ${t.name}`))}}),m.value=[],A.value=0,w.value=0,z.value=null,r.value={name:"",number:"",expMonth:"",expYear:"",cvv:""}},F=p(!1),H=async()=>{if(m.value.length===0){o.error("Cart is empty");return}if(y.value==="cash"&&Number(w.value)<g.value){o.error("Amount paid is less than the total");return}if(y.value==="momo"){await le();return}if(!F.value){F.value=!0;try{const t=`INV-CUS-${Date.now()}`;console.log("Generated invoice ID for payment:",t);const e={_id:t,date:Date.now(),customer:z.value,items:m.value.map(s=>({medicine:s._id,medicine_name:s.name,quantity:s.quantity,price:s.price,original_price:s.original_price||s.price,discount_percentage:s.discount_percentage||0,discount_reason:s.discount_reason||"",vat:s.vat,subtotal:s.price*s.quantity,batch_id:s.batch_id,expiry_date:s.expiry_date,purchase:s.purchase,stock_id:s.stock_id,days_left:s.days_left})),subtotal:V.value,vat_total:B.value,discount:A.value,grand_total:g.value,paid:y.value==="cash"?Number(w.value):g.value,due:y.value==="cash"?Number(w.value)>g.value?0:g.value-Number(w.value):0,payment_method:y.value,payment_status:"paid",payment_details:y.value==="card"?{card_type:_e(r.value.number),card_number:ye(r.value.number),card_holder:r.value.name}:null,is_pos:!0};console.log("Creating POS invoice with data:",e);const l=await D.post("/api/invoice/pos",e);l&&l.status?(o.success("Transaction completed successfully"),G(),await J()):o.error(l.message||"Failed to create invoice")}catch(t){console.error("Payment error:",t),o.error(t.message||"Failed to process payment")}finally{F.value=!1}}},J=async()=>{W.value=!0;try{const t=Date.now(),e=await D.get("/api/medicine",{params:{limit:100,populate:"stocks",_t:t}});if(e&&e.data){T.value=e.data;const l=new Set(["all"]);e.data.forEach(s=>{var f;(f=s.category)!=null&&f.name&&l.add(s.category.name)}),Z.value=Array.from(l).map(s=>({id:s,name:s==="all"?"All":s}))}}catch(t){console.error("Failed to fetch medicines:",t),o.error("Could not load medicine data")}finally{W.value=!1}},pe=async()=>{try{const t=await D.get("/api/customers",{params:{limit:100}});t&&t.data&&(ee.value=t.data.map(e=>({label:e.full_name,value:e._id})))}catch(t){console.error("Failed to fetch customers:",t)}},Y=t=>!t.stocks||t.stocks.length===0?0:t.stocks.filter(l=>new Date(l.expiry_date)>new Date).reduce((l,s)=>l+(s.unit_quantity||0),0),ve=()=>{m.value.forEach(t=>{t.original_price&&t.discount_percentage&&(t.price=t.original_price*(1-t.discount_percentage/100));const e=T.value.find(l=>l._id===t._id);if(e){const l=e.stocks.find(s=>s._id===t.stock_id);if(l){const s=t.max_quantity;l.unit_quantity=s-t.quantity}}})},me=()=>{if(!r.value.name.trim()){o.error("Please enter the cardholder name");return}if(!r.value.number){o.error("Please select a card number");return}if(!r.value.expMonth){o.error("Please select expiry month");return}if(!r.value.expYear){o.error("Please select expiry year");return}const t=new Date,e=t.getFullYear(),l=t.getMonth()+1,s=parseInt(r.value.expYear),f=parseInt(r.value.expMonth);if(s<e||s===e&&f<l){o.error("Card has expired. Please use a valid expiry date");return}if(!r.value.cvv||r.value.cvv.length<3){o.error("Please enter a valid CVV");return}o.success("Card payment successful"),H()},fe=()=>{o.success("Bank transfer payment successful"),H()},_e=t=>t?/^4/.test(t)?"Visa":/^5[1-5]/.test(t)?"Mastercard":/^3[47]/.test(t)?"American Express":/^6(?:011|5)/.test(t)?"Discover":"Unknown":"",ye=t=>{if(!t)return"";const e=t.slice(-4);return"*".repeat(t.length-4)+e},ge=async()=>{try{const t=await D.get("/api/bank",{params:{limit:1,status:!0}});t&&t.data&&t.data.length>0&&(R.value=t.data[0])}catch(t){console.error("Failed to fetch bank account:",t)}},be=async t=>{if(t){o.loading("Scanning product barcode..."),console.log(`Scanning barcode: ${t}`);try{const e=Date.now(),l=await D.get("/api/medicine",{params:{bar_code:t,populate:"stocks",limit:1,_t:e}});if(console.log("Barcode search response:",l),l&&l.data&&l.data.length>0){const s=l.data[0];console.log("Found medicine:",s.name,"with ID:",s._id),se(s),o.success(`Found and added ${s.name} to cart`)}else o.error(`Barcode ${t} not found in system`)}catch(e){console.error("Barcode scan error:",e),o.error("Failed to process barcode")}}},le=async()=>{if(m.value.length===0){o.error("Cart is empty");return}if(!Q.value){Q.value=!0;try{C.value=`INV-CUS-${Date.now()}`;const t={_id:C.value,date:Date.now(),customer:z.value,items:m.value.map(s=>({medicine:s._id,medicine_name:s.name,quantity:s.quantity,price:s.price,original_price:s.original_price||s.price,discount_percentage:s.discount_percentage||0,discount_reason:s.discount_reason||"",vat:s.vat,subtotal:s.price*s.quantity,batch_id:s.batch_id,expiry_date:s.expiry_date,purchase:s.purchase,stock_id:s.stock_id,days_left:s.days_left})),subtotal:V.value,vat_total:B.value,discount:A.value,grand_total:g.value,paid:g.value,due:0,payment_method:"momo",payment_status:"paid",payment_details:{order_id:C.value},is_pos:!0};console.log("Creating invoice before MoMo payment:",t);const e=await D.post("/api/invoice/pos",t);if(!e||!e.status)throw new Error((e==null?void 0:e.message)||"Failed to create invoice");console.log("Invoice created successfully:",e);const l=await D.post("/api/payment/momo",{amount:g.value,orderId:C.value,orderInfo:`Payment for invoice ${C.value}`});l&&l.data?(q.value=l.data.payUrl,X.value=l.data.qrCodeUrl,o.success("MoMo payment initiated successfully"),l.data.payUrl&&window.open(l.data.payUrl,"_blank"),he()):o.error("Failed to initiate MoMo payment")}catch(t){o.error(t.message||"An unexpected error occurred"),console.error("MoMo payment error:",t)}finally{Q.value=!1}}},xe=()=>{q.value?window.open(q.value,"_blank"):o.warning("No payment URL available")},he=()=>{if(!C.value){console.error("No order ID available for status check");return}j.value="Checking...";let t=0;const e=60,l=qe(async()=>{try{t++,console.log(`Checking MoMo payment status... Attempt ${t} for ${C.value}`);const s=await D.get("/api/payment/momo/status",{params:{orderId:C.value}});console.log("Status check response:",s),s&&s.data&&(s.data.status==="paid"?(j.value="Paid",clearInterval(l),o.success("Payment successful!"),G(),J()):s.data.status==="not_found"&&(j.value="Checking...",console.log("Invoice not found yet, continuing to check..."))),t>=e&&(clearInterval(l),j.value="Timeout",o.warning("Payment verification timeout. Please check manually."))}catch(s){console.error("Error checking payment status:",s),j.value="Error checking status"}},5e3)};return Ce(async()=>{await Promise.all([J(),pe(),ge()])}),(t,e)=>{const l=je,s=Ie,f=Ae,L=Ne,M=Ue,b=Te,$=Se;return c(),v("div",Ve,[a("div",Be,[i(l,{size:"small"},{default:_(()=>[i(Pe,{onDecode:be,title:"Scan Product Barcode"})]),_:1}),a("div",Fe,[a("div",Ye,[i(s,{type:"text",placeholder:"Search medicines...",value:E.value,"onUpdate:value":e[0]||(e[0]=n=>E.value=n)},null,8,["value"])]),a("div",Ee,[(c(!0),v(N,null,K(Z.value,n=>(c(),O(f,{key:n.id,type:U.value===n.id?"primary":"default",onClick:h=>ce(n.id),class:ne(["whitespace-nowrap bg-blue-100 text-blue-700 hover:bg-blue-200",{"bg-blue-600 text-white hover:bg-blue-700":U.value===n.id}])},{default:_(()=>[P(u(n.name),1)]),_:2},1032,["type","onClick","class"]))),128))])]),i(l,{class:"flex-1 overflow-y-auto"},{default:_(()=>[W.value?(c(),v("div",Re,[i(L,{size:"large"})])):te.value.length===0?(c(),v("div",Qe," No medicines found ")):(c(),v("div",Le,[(c(!0),v(N,null,K(te.value,n=>(c(),O(l,{key:n._id,class:"cursor-pointer hover:border-primary transition-colors",onClick:h=>se(n),size:"small"},{default:_(()=>{var h;return[a("div",Oe,[a("img",{src:n.image||"/medicine-placeholder.png",alt:n.name,class:"object-cover w-full h-full"},null,8,We)]),a("h3",Xe,u(n.name),1),a("div",Ge,[a("span",He,u(((h=n.category)==null?void 0:h.name)||"N/A"),1),a("span",Je,u(x(n.price)),1)]),a("div",Ke,[e[10]||(e[10]=a("span",{class:"text-xs text-gray-500"},"Stock:",-1)),a("span",{class:ne(["text-xs font-medium",{"text-green-600":Y(n)>10,"text-amber-600":Y(n)>0&&Y(n)<=10,"text-red-600":Y(n)===0}])},u(Y(n)),3)])]}),_:2},1032,["onClick"]))),128))]))]),_:1})]),a("div",Ze,[i(l,{size:"small"},{default:_(()=>[e[11]||(e[11]=a("h3",{class:"font-medium mb-2"},"Customer",-1)),i(M,{value:z.value,"onUpdate:value":e[1]||(e[1]=n=>z.value=n),options:ee.value,placeholder:"Walk-in Customer",clearable:""},null,8,["value","options"])]),_:1,__:[11]}),i(l,{title:"Cart",size:"small",class:"flex-1 overflow-y-auto"},{default:_(()=>[m.value.length===0?(c(),v("div",et," Cart is empty ")):(c(),v("div",tt,[(c(!0),v(N,null,K(m.value,(n,h)=>(c(),v("div",{key:h,class:"flex flex-col border-b border-gray-200 pb-2"},[a("div",at,[a("div",st,[a("div",lt,u(n.name),1),a("div",nt,[P(u(x(n.price))+" × ",1),i(b,{value:n.quantity,"onUpdate:value":[k=>n.quantity=k,ve],size:"small",min:1,max:n.max_quantity,class:"inline-block w-16"},null,8,["value","onUpdate:value","max"])]),a("div",ot," Stock: "+u(n.max_quantity),1),n.discount_percentage>0?(c(),v("div",rt,[P(u(n.discount_percentage)+"% discount ("+u(n.discount_reason)+") ",1),a("span",it,u(x(n.original_price)),1)])):S("",!0)]),a("div",ut,[a("span",ct,u(x(n.price*n.quantity)),1),i(f,{quaternary:"",circle:"",size:"small",onClick:k=>de(h)},{icon:_(()=>[i(Me($e),{class:"h-4 w-4 text-red-500"})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1}),i(l,{size:"small",class:"space-y-2"},{default:_(()=>[a("div",dt,[e[12]||(e[12]=a("span",null,"Subtotal",-1)),a("span",null,u(x(V.value)),1)]),a("div",pt,[e[13]||(e[13]=a("span",null,"VAT",-1)),a("span",null,u(x(B.value)),1)]),a("div",vt,[e[14]||(e[14]=a("span",null,"Discount",-1)),a("div",mt,[i(b,{value:A.value,"onUpdate:value":e[2]||(e[2]=n=>A.value=n),class:"w-20",size:"small",min:0,max:V.value+B.value},null,8,["value","max"]),a("span",null,u(x(A.value)),1)])]),i($),a("div",ft,[e[15]||(e[15]=a("span",null,"Total",-1)),a("span",null,u(x(g.value)),1)])]),_:1}),i(l,{size:"small",class:"space-y-2"},{default:_(()=>{var n,h,k;return[a("div",_t,[e[16]||(e[16]=a("span",null,"Payment Method",-1)),i(M,{value:y.value,"onUpdate:value":e[3]||(e[3]=d=>y.value=d),class:"w-32",size:"small",options:[{label:"Cash",value:"cash"},{label:"Card",value:"card"},{label:"Bank Transfer",value:"bank"},{label:"MoMo",value:"momo"}]},null,8,["value"])]),y.value==="cash"?(c(),v(N,{key:0},[a("div",yt,[e[17]||(e[17]=a("span",null,"Amount Paid",-1)),i(b,{value:w.value,"onUpdate:value":e[4]||(e[4]=d=>w.value=d),class:"w-32",size:"small",min:0},null,8,["value"])]),ae.value>0?(c(),v("div",gt,[e[18]||(e[18]=a("span",null,"Change",-1)),a("span",null,u(x(ae.value)),1)])):S("",!0)],64)):y.value==="card"?(c(),v(N,{key:1},[a("div",bt,[e[24]||(e[24]=a("p",{class:"text-sm text-center text-gray-500 mb-2"},"Please provide card information",-1)),a("div",xt,[a("div",ht,[e[19]||(e[19]=a("span",{class:"w-24 text-xs"},"Card Holder",-1)),i(s,{value:r.value.name,"onUpdate:value":e[5]||(e[5]=d=>r.value.name=d),size:"small",placeholder:"Enter cardholder name"},null,8,["value"])]),a("div",kt,[e[20]||(e[20]=a("span",{class:"w-24 text-xs"},"Card Number",-1)),i(M,{value:r.value.number,"onUpdate:value":e[6]||(e[6]=d=>r.value.number=d),size:"small",placeholder:"Select test card",options:oe.value},null,8,["value","options"])]),a("div",wt,[e[22]||(e[22]=a("span",{class:"w-24 text-xs"},"Expiry Date",-1)),a("div",Ct,[i(M,{value:r.value.expMonth,"onUpdate:value":e[7]||(e[7]=d=>r.value.expMonth=d),size:"small",placeholder:"MM",class:"w-16",options:re.value},null,8,["value","options"]),e[21]||(e[21]=a("span",null,"/",-1)),i(M,{value:r.value.expYear,"onUpdate:value":e[8]||(e[8]=d=>r.value.expYear=d),size:"small",placeholder:"YY",class:"w-16",options:ie.value},null,8,["value","options"])])]),a("div",Mt,[e[23]||(e[23]=a("span",{class:"w-24 text-xs"},"CVV",-1)),i(s,{value:r.value.cvv,"onUpdate:value":e[9]||(e[9]=d=>r.value.cvv=d),size:"small",placeholder:"XXX",class:"w-16"},null,8,["value"])])]),e[25]||(e[25]=a("div",{class:"mt-3 p-2 bg-blue-50 rounded text-xs text-blue-600"}," Test cards are provided by PayPal Sandbox. Select any card to test payment. ",-1))]),a("div",Pt,[e[26]||(e[26]=a("span",null,"Full Payment",-1)),a("span",qt,u(x(g.value)),1)]),i(f,{type:"primary",class:"w-full mt-2",disabled:!r.value.name||!r.value.number||!r.value.expMonth||!r.value.expYear||!r.value.cvv,onClick:me},{default:_(()=>e[27]||(e[27]=[P(" Pay ")])),_:1,__:[27]},8,["disabled"])],64)):y.value==="bank"?(c(),v(N,{key:2},[a("div",Dt,[e[33]||(e[33]=a("h3",{class:"font-medium text-lg mb-1"},"Payment Information",-1)),e[34]||(e[34]=a("p",{class:"text-sm text-center mb-4"},"Scan QR code to make payment",-1)),a("div",At,[e[28]||(e[28]=a("h4",{class:"text-blue-600 font-medium mb-2"},"Techcombank",-1)),a("div",$t,[a("img",{src:((n=R.value)==null?void 0:n.qr_image)||"/techcom-qr.png",alt:"Bank QR Code",class:"w-48 h-48"},null,8,St)])]),a("div",jt,[a("div",It,[e[29]||(e[29]=a("span",{class:"font-medium"},"Account Name:",-1)),a("span",null,u(((h=R.value)==null?void 0:h.account_name)||"Thái"),1)]),a("div",Nt,[e[30]||(e[30]=a("span",{class:"font-medium"},"Account Number:",-1)),a("span",null,u(((k=R.value)==null?void 0:k.account_number)||"8524092000"),1)]),a("div",Ut,[e[31]||(e[31]=a("span",{class:"font-medium"},"Amount:",-1)),a("span",Tt,u(x(g.value)),1)]),e[32]||(e[32]=a("div",{class:"flex justify-between py-2"},[a("span",{class:"font-medium"},"Reference:"),a("span",null,"Payment for order")],-1))])]),i(f,{type:"primary",class:"w-full mt-4",onClick:fe},{default:_(()=>e[35]||(e[35]=[P(" Complete Payment ")])),_:1,__:[35]})],64)):y.value==="momo"?(c(),v("div",zt,[e[40]||(e[40]=a("h3",{class:"font-medium text-lg mb-1"},"MoMo Payment",-1)),e[41]||(e[41]=a("p",{class:"text-sm text-center mb-4"},"Scan QR code or click button to pay with MoMo",-1)),q.value?(c(),v("div",Vt,[a("div",Bt,[X.value?(c(),v("img",{key:0,src:X.value,alt:"MoMo QR Code",class:"w-48 h-48"},null,8,Ft)):(c(),v("div",Yt,[i(L,{size:"large"})]))]),a("div",Et,[a("p",Rt,"Order ID: "+u(C.value),1)])])):S("",!0),a("div",Qt,[a("div",Lt,[e[36]||(e[36]=a("span",{class:"font-medium"},"Amount:",-1)),a("span",Ot,u(x(g.value)),1)]),a("div",Wt,[e[37]||(e[37]=a("span",{class:"font-medium"},"Status:",-1)),a("span",Xt,u(j.value),1)])]),a("div",Gt,[i(f,{type:"primary",class:"flex-1",onClick:le,loading:Q.value,disabled:q.value},{icon:_(()=>e[38]||(e[38]=[a("img",{src:ze,class:"w-5 h-5"},null,-1)])),default:_(()=>[P(" "+u(q.value?"Payment Initiated":"Pay with MoMo"),1)]),_:1},8,["loading","disabled"]),q.value?(c(),O(f,{key:0,type:"info",class:"flex-1",onClick:xe},{default:_(()=>e[39]||(e[39]=[P(" Open MoMo App ")])),_:1,__:[39]})):S("",!0)]),q.value?(c(),v("div",Ht," Waiting for payment confirmation. This page will update automatically. ")):S("",!0)])):S("",!0)]}),_:1}),a("div",Jt,[i(f,{type:"default",class:"flex-1",onClick:G},{default:_(()=>e[42]||(e[42]=[P("Clear All")])),_:1,__:[42]}),y.value==="cash"?(c(),O(f,{key:0,type:"primary",class:"flex-1",onClick:H,disabled:!ue.value||F.value,loading:F.value},{default:_(()=>e[43]||(e[43]=[P(" Complete ")])),_:1,__:[43]},8,["disabled","loading"])):S("",!0)])])])}}};export{Ca as default};
